@import url('https://fonts.googleapis.com/css2?family=Fredoka+One&family=Nunito:wght@700;800;900&display=swap');
*,*::before,*::after{margin:0;padding:0;box-sizing:border-box;-webkit-tap-highlight-color:transparent;}
html,body{width:100%;height:100%;overflow:hidden;touch-action:none;user-select:none;font-family:'Nunito',sans-serif;}

.screen{position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;transition:opacity .25s;z-index:1;}
.screen.off{opacity:0;pointer-events:none;}

/* GAME */
#sGame{background:#87ceeb;}
#cvs{position:absolute;inset:0;width:100%;height:100%;display:block;}
#danger{position:absolute;inset:0;pointer-events:none;z-index:9;box-shadow:inset 0 0 0 7px #e53935;opacity:0;transition:opacity .12s;}
#hud{position:absolute;top:0;left:0;right:0;z-index:10;padding:max(env(safe-area-inset-top,0px),10px) 14px 10px;display:flex;align-items:center;justify-content:space-between;gap:8px;background:linear-gradient(180deg,rgba(0,0,0,.25),transparent);pointer-events:none;}
#hud>*{pointer-events:all;}
.pill{display:flex;align-items:center;gap:5px;background:rgba(0,0,0,.32);border-radius:30px;padding:5px 13px 5px 8px;}
.pill-coin{width:22px;height:22px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#ffe082,#ffd700,#e65100);border:2px solid rgba(255,255,255,.4);flex-shrink:0;}
.pill span{color:#fff;font-family:'Fredoka One',cursive;font-size:1rem;text-shadow:0 1px 3px rgba(0,0,0,.5);}
#hudScore{color:#fff;font-family:'Fredoka One',cursive;font-size:1rem;text-shadow:0 1px 4px rgba(0,0,0,.5);}
#btnShop{background:linear-gradient(135deg,#ffca28,#ff8f00);border:none;border-radius:22px;padding:7px 15px;color:#5d2e00;font-family:'Fredoka One',cursive;font-size:.85rem;cursor:pointer;box-shadow:0 3px 10px rgba(0,0,0,.3);}
#btnMusic{background:rgba(255,255,255,.22);border:none;border-radius:22px;padding:7px 12px;color:#fff;font-size:1rem;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.2);}
#btnMusic.muted{opacity:.45;}
.floaty{position:absolute;font-family:'Fredoka One',cursive;font-size:1.2rem;color:#fff;text-shadow:0 2px 6px rgba(0,0,0,.4);pointer-events:none;animation:floatUp .9s ease-out forwards;z-index:15;transform:translateX(-50%);}
@keyframes floatUp{0%{opacity:1;transform:translateX(-50%) translateY(0) scale(1)}100%{opacity:0;transform:translateX(-50%) translateY(-65px) scale(1.3)}}
#toast{position:absolute;top:72px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.75);color:#fff;font-family:'Fredoka One',cursive;font-size:.95rem;padding:8px 22px;border-radius:30px;opacity:0;pointer-events:none;white-space:nowrap;z-index:20;transition:opacity .25s;}
#toast.show{opacity:1;}

/* MENU */
#sMenu{background:linear-gradient(160deg,#1565c0,#0d47a1,#1a237e);justify-content:center;gap:18px;}
.logo{font-family:'Fredoka One',cursive;font-size:2.8rem;color:#fff;text-shadow:0 4px 20px rgba(0,0,0,.4);letter-spacing:2px;}
.menu-coins{display:flex;align-items:center;gap:8px;background:rgba(255,255,255,.15);border-radius:30px;padding:8px 20px;}
.mc-coin{width:26px;height:26px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#ffe082,#ffd700,#e65100);border:2px solid rgba(255,255,255,.4);}
.menu-coins span{color:#ffd600;font-family:'Fredoka One',cursive;font-size:1.3rem;}
.big-btn{width:min(300px,80vw);padding:16px 0;border:none;border-radius:18px;font-family:'Fredoka One',cursive;font-size:1.4rem;cursor:pointer;box-shadow:0 6px 20px rgba(0,0,0,.3);transition:transform .1s;}
.big-btn:active{transform:scale(.96);}
.btn-play{background:linear-gradient(135deg,#66bb6a,#2e7d32);color:#fff;}
.btn-shop-menu{background:linear-gradient(135deg,#ffd600,#ff8f00);color:#5d2e00;}
#tapOverlay{position:fixed;inset:0;z-index:999;background:linear-gradient(160deg,#1565c0,#0d47a1,#1a237e);display:flex;align-items:center;justify-content:center;cursor:pointer;}
#tapBox{display:flex;flex-direction:column;align-items:center;gap:16px;text-align:center;padding:30px;}
#tapApple{font-size:5rem;animation:tapBounce 1s ease-in-out infinite alternate;}
@keyframes tapBounce{from{transform:scale(1) rotate(-8deg)}to{transform:scale(1.12) rotate(8deg)}}
#tapTitle{font-family:'Fredoka One',cursive;font-size:3rem;color:#fff;text-shadow:0 4px 20px rgba(0,0,0,.4);letter-spacing:2px;}
#tapBtn{background:linear-gradient(135deg,#66bb6a,#2e7d32);color:#fff;font-family:'Fredoka One',cursive;font-size:1.6rem;padding:18px 50px;border-radius:20px;box-shadow:0 6px 24px rgba(0,0,0,.35);animation:tapPulse 1.4s ease-in-out infinite;}
@keyframes tapPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
#tapSub{color:rgba(255,255,255,.6);font-size:.9rem;font-weight:700;}

/* GAME OVER */
#sGameOver{background:linear-gradient(160deg,#b71c1c,#7f0000);justify-content:center;gap:16px;}
.go-title{font-family:'Fredoka One',cursive;font-size:2.6rem;color:#fff;text-shadow:0 4px 16px rgba(0,0,0,.5);}
@keyframes goWobble{from{transform:rotate(-12deg)}to{transform:rotate(12deg)}}
#goAppleCanvas{animation:goWobble .6s ease-in-out infinite alternate;}
.go-card{background:rgba(255,255,255,.12);border-radius:20px;padding:16px 30px;color:#fff;font-size:1rem;font-weight:800;text-align:center;line-height:2.1;}
.go-card b{font-family:'Fredoka One',cursive;font-size:1.5rem;color:#ffd600;}
.go-penalty{color:#ff8a80;font-size:.9rem;font-weight:700;}
.btn-retry{background:linear-gradient(135deg,#ef5350,#b71c1c);color:#fff;}
.btn-menu2{background:rgba(255,255,255,.18);color:#fff;border:2px solid rgba(255,255,255,.3);}

/* SHOP */
#sShop{background:linear-gradient(160deg,#4a148c,#6a1b9a);overflow-y:auto;padding-bottom:max(env(safe-area-inset-bottom,0px),20px);}
.shop-header{position:sticky;top:0;width:100%;z-index:10;background:rgba(74,20,140,.97);padding:max(env(safe-area-inset-top,0px),12px) 16px 12px;display:flex;align-items:center;justify-content:space-between;gap:8px;}
.shop-title{font-family:'Fredoka One',cursive;font-size:1.7rem;color:#fff;}
.shop-coins{display:flex;align-items:center;gap:5px;}
.sc-coin{width:20px;height:20px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#ffe082,#ffd700,#e65100);border:2px solid rgba(255,255,255,.4);}
.shop-coins span{color:#ffd600;font-family:'Fredoka One',cursive;font-size:1.1rem;}
.btn-back{background:rgba(255,255,255,.15);border:none;border-radius:12px;padding:8px 14px;color:#fff;font-family:'Fredoka One',cursive;font-size:.85rem;cursor:pointer;white-space:nowrap;}
.shop-body{width:100%;max-width:500px;padding:14px 16px;display:flex;flex-direction:column;gap:22px;}
.sec-title{font-family:'Fredoka One',cursive;font-size:1.1rem;color:rgba(255,255,255,.65);letter-spacing:1px;}

/* Chests */
.chest-grid{display:grid;grid-template-columns:repeat(3,1fr);gap:10px;}
.chest-card{background:rgba(255,255,255,.1);border-radius:16px;padding:10px 8px 12px;display:flex;flex-direction:column;align-items:center;gap:5px;border:2px solid transparent;}
.chest-name{color:#fff;font-size:.72rem;font-weight:800;text-align:center;}
.chest-cost{display:flex;align-items:center;gap:3px;color:#ffd600;font-family:'Fredoka One',cursive;font-size:.8rem;}
.cc-coin{width:12px;height:12px;border-radius:50%;background:radial-gradient(circle at 35% 35%,#ffe082,#ffd700,#e65100);flex-shrink:0;}
.chest-buy-btn{background:linear-gradient(135deg,#ffd600,#ff8f00);border:none;border-radius:10px;padding:6px 0;color:#5d2e00;font-family:'Fredoka One',cursive;font-size:.78rem;cursor:pointer;width:100%;margin-top:2px;}
.chest-buy-btn:disabled{background:rgba(255,255,255,.18);color:rgba(255,255,255,.35);cursor:not-allowed;}

/* Skins */
.skin-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px;}
.skin-card{background:rgba(255,255,255,.1);border-radius:14px;padding:10px 4px 8px;display:flex;flex-direction:column;align-items:center;gap:4px;cursor:pointer;border:2px solid transparent;position:relative;transition:transform .1s;}
.skin-card:active{transform:scale(.93);}
.skin-card.selected{border-color:#ffd600;background:rgba(255,214,0,.18);}
.skin-card.locked{opacity:.5;cursor:default;}
.skin-name{color:#fff;font-size:.6rem;font-weight:800;text-align:center;line-height:1.2;}
.map-progress{color:rgba(255,255,255,.6);font-size:.78rem;font-weight:700;margin-bottom:-8px;}
.map-card{background:rgba(255,255,255,.1);border-radius:14px;padding:10px 4px 8px;display:flex;flex-direction:column;align-items:center;gap:4px;cursor:pointer;border:2px solid transparent;position:relative;transition:transform .1s;}
.map-card:active{transform:scale(.93);}
.map-card.selected{border-color:#ffd600;background:rgba(255,214,0,.18);}
.map-card.locked{opacity:.45;cursor:default;}
.map-emoji{font-size:1.6rem;line-height:1;}
.map-name{color:#fff;font-size:.6rem;font-weight:800;text-align:center;line-height:1.2;}
.map-req{color:rgba(255,255,255,.55);font-size:.52rem;font-weight:700;text-align:center;}
.skin-badge{position:absolute;top:3px;right:3px;color:#fff;font-size:.48rem;font-weight:900;padding:2px 5px;border-radius:8px;}
.skin-badge.lock-badge{background:#c62828;}
.skin-badge.equip-badge{background:#ffd600;color:#5d2e00;}

/* CHEST OPEN OVERLAY */
#chestOpen{position:fixed;inset:0;z-index:100;background:rgba(0,0,0,.9);display:flex;flex-direction:column;align-items:center;justify-content:center;gap:20px;opacity:0;pointer-events:none;transition:opacity .3s;}
#chestOpen.show{opacity:1;pointer-events:all;}
@keyframes chestBounce{from{transform:scale(1) rotate(-4deg)}to{transform:scale(1.08) rotate(4deg)}}
#chestOpenCanvas{animation:chestBounce .45s ease-in-out infinite alternate;}
@keyframes revealPop{from{transform:scale(0) rotate(-15deg)}to{transform:scale(1) rotate(0deg)}}
#chestRevealCanvas{animation:revealPop .5s cubic-bezier(.34,1.56,.64,1);}
.chest-msg{font-family:'Fredoka One',cursive;font-size:1.5rem;color:#fff;text-align:center;padding:0 20px;}
.chest-sub{color:rgba(255,255,255,.65);font-size:.95rem;font-weight:700;text-align:center;}
.chest-close-btn{background:linear-gradient(135deg,#ffd600,#ff8f00);border:none;border-radius:16px;padding:14px 40px;color:#5d2e00;font-family:'Fredoka One',cursive;font-size:1.1rem;cursor:pointer;}

/* MODE SELECT */
.mode-row{display:flex;gap:12px;width:min(300px,80vw);}
.mode-btn{flex:1;padding:14px 0;border:3px solid transparent;border-radius:18px;font-family:'Fredoka One',cursive;font-size:1.05rem;cursor:pointer;box-shadow:0 4px 14px rgba(0,0,0,.25);transition:transform .1s,border-color .15s;background:rgba(255,255,255,.12);color:#fff;}
.mode-btn:active{transform:scale(.95);}
.mode-btn.active{border-color:#ffd600;background:rgba(255,214,0,.2);}

/* TIMER HUD */
#timerBar{position:absolute;bottom:0;left:0;height:5px;background:#ffd600;z-index:11;transition:width .9s linear;}
#hudTimer{font-family:'Fredoka One',cursive;font-size:1.05rem;color:#fff;text-shadow:0 1px 4px rgba(0,0,0,.5);}
#hudTimer.urgent{color:#ff5252;animation:timerPulse .4s ease-in-out infinite alternate;}
@keyframes timerPulse{from{transform:scale(1)}to{transform:scale(1.2)}}

/* TIMER END SCREEN */
#sTimerEnd{background:linear-gradient(160deg,#1b5e20,#2e7d32);justify-content:center;gap:14px;}
.te-trophy{font-size:4rem;animation:teSpin .8s ease-in-out infinite alternate;}
@keyframes teSpin{from{transform:rotate(-10deg) scale(1)}to{transform:rotate(10deg) scale(1.08)}}
.te-title{font-family:'Fredoka One',cursive;font-size:2.2rem;color:#fff;text-shadow:0 4px 16px rgba(0,0,0,.4);text-align:center;}
.te-card{background:rgba(255,255,255,.13);border-radius:20px;padding:16px 32px;color:#fff;font-size:1rem;font-weight:800;text-align:center;line-height:2.2;min-width:230px;}
.te-card b{font-family:'Fredoka One',cursive;font-size:1.5rem;color:#ffd600;}
.te-card .neg{color:#ff8a80;}
.btn-green{background:linear-gradient(135deg,#66bb6a,#2e7d32);color:#fff;}
.btn-grey{background:rgba(255,255,255,.18);color:#fff;border:2px solid rgba(255,255,255,.3);}

/* VICTORY SCREEN */
#sVictory{background:linear-gradient(160deg,#7b1fa2,#4a148c,#1a237e);justify-content:center;gap:14px;overflow:hidden;}
.vc-firework{position:absolute;pointer-events:none;font-size:1.8rem;animation:vcFloat 3s ease-in-out infinite;}
@keyframes vcFloat{0%{transform:translateY(0) scale(1);opacity:1}100%{transform:translateY(-120px) scale(0.3);opacity:0}}
.vc-trophy{font-size:5rem;animation:vcBounce .7s ease-in-out infinite alternate;}
@keyframes vcBounce{from{transform:scale(1) rotate(-6deg)}to{transform:scale(1.1) rotate(6deg)}}
.vc-title{font-family:'Fredoka One',cursive;font-size:2.4rem;color:#ffd600;text-shadow:0 0 30px #ffd600,0 4px 16px rgba(0,0,0,.5);text-align:center;}
.vc-sub{color:rgba(255,255,255,.8);font-family:'Fredoka One',cursive;font-size:1rem;text-align:center;padding:0 20px;}
.vc-card{background:rgba(255,255,255,.12);border-radius:20px;padding:14px 28px;color:#fff;font-size:.88rem;font-weight:800;line-height:2;text-align:center;}
.vc-card b{color:#ffd600;font-family:'Fredoka One',cursive;font-size:1.1rem;}
.btn-gold{background:linear-gradient(135deg,#ffd600,#ff8f00);color:#5d2e00;}

/* CREDITS SCREEN */
#sCredits{background:#000;justify-content:flex-start;overflow:hidden;}
#creditsScroll{position:absolute;width:100%;text-align:center;animation:creditsRoll 18s linear forwards;}
@keyframes creditsRoll{from{top:100%}to{top:-180%}}
.cr-spacer{height:60px;}
.cr-logo{font-family:'Fredoka One',cursive;font-size:2.8rem;color:#ffd600;text-shadow:0 0 30px #ffd600;margin-bottom:8px;}
.cr-tagline{color:rgba(255,255,255,.5);font-size:.9rem;font-weight:700;margin-bottom:40px;}
.cr-role{color:rgba(255,255,255,.45);font-size:.78rem;font-weight:700;letter-spacing:2px;text-transform:uppercase;margin-top:28px;margin-bottom:4px;}
.cr-name{color:#fff;font-family:'Fredoka One',cursive;font-size:1.5rem;}
.cr-divider{color:rgba(255,255,255,.15);font-size:1.4rem;margin:24px 0;}
.cr-thanks{font-family:'Fredoka One',cursive;font-size:1.8rem;color:#ffd600;text-shadow:0 0 20px #ffd600;margin-top:30px;}
.cr-heart{font-size:2.5rem;animation:crPulse .8s ease-in-out infinite alternate;}
@keyframes crPulse{from{transform:scale(1)}to{transform:scale(1.2)}}
.cr-end-spacer{height:120px;}

/* POWER BAR */
#powerBar{position:absolute;bottom:36px;left:50%;transform:translateX(-50%);display:flex;gap:8px;z-index:12;}
.pw-slot{width:52px;height:52px;background:rgba(0,0,0,.45);border:2px solid rgba(255,255,255,.2);border-radius:14px;display:flex;align-items:center;justify-content:center;font-size:1.5rem;cursor:pointer;position:relative;}
.pw-slot.empty{opacity:.3;}
.pw-slot.active-glow{border-color:#ffd600;box-shadow:0 0 14px #ffd600;}
.pw-slot-count{position:absolute;bottom:2px;right:4px;font-size:.55rem;font-weight:800;color:#ffd600;font-family:'Fredoka One',cursive;}


.pu-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(130px,1fr));gap:10px;padding:4px 0;}
.pu-card{background:rgba(255,255,255,.08);border-radius:14px;padding:12px 8px;display:flex;flex-direction:column;align-items:center;gap:5px;}
.pu-icon{font-size:2rem;}
.pu-name{color:#fff;font-family:'Fredoka One',cursive;font-size:.88rem;text-align:center;}
.pu-qty{color:#ffd600;font-size:.72rem;font-weight:800;}
.pu-rare{color:rgba(255,255,255,.35);font-size:.6rem;font-weight:700;}

/* WHAT'S NEW OVERLAY */
#updateOverlay{position:fixed;inset:0;z-index:200;background:rgba(0,0,0,.78);display:flex;align-items:center;justify-content:center;padding:20px;opacity:0;pointer-events:none;transition:opacity .25s;}
#updateOverlay.show{opacity:1;pointer-events:all;}
#updateBox{background:linear-gradient(160deg,#0d1b2a,#1b2838);border:2px solid rgba(255,214,0,.25);border-radius:28px;padding:22px 18px;width:100%;max-width:420px;max-height:86vh;overflow-y:auto;}
.up-title{font-family:'Fredoka One',cursive;font-size:1.7rem;color:#fff;text-align:center;margin-bottom:20px;}
.up-section{margin-bottom:14px;}
.up-sec-title{color:#ffd600;font-family:'Fredoka One',cursive;font-size:1rem;margin-bottom:8px;}
.up-item{display:flex;gap:10px;background:rgba(255,255,255,.06);border-radius:12px;padding:10px 12px;margin-bottom:7px;}
.up-icon{font-size:1.6rem;flex-shrink:0;}
.up-name{color:#fff;font-family:'Fredoka One',cursive;font-size:.95rem;}
.up-desc{color:rgba(255,255,255,.45);font-size:.72rem;margin-top:2px;}
.up-close{width:100%;margin-top:14px;background:rgba(255,255,255,.1);border:none;border-radius:14px;padding:12px;color:#fff;font-family:'Fredoka One',cursive;font-size:1rem;cursor:pointer;}


.reward-item{display:flex;align-items:center;gap:8px;padding:8px;background:rgba(255,255,255,.04);border-radius:10px;margin-bottom:6px;}
.reward-map{font-size:1.2rem;}
.reward-info{flex:1;}
.reward-name{color:#fff;font-size:.8rem;font-weight:700;}
.reward-desc{color:rgba(255,255,255,.4);font-size:.65rem;}
.reward-status{font-size:.65rem;font-weight:800;}
.reward-status.locked{color:rgba(255,255,255,.3);}
.reward-status.claimed{color:#80e080;}

/* ═══ ACCOUNT SCREEN ═══ */
#sAccount{background:linear-gradient(160deg,#1565c0,#0d47a1,#1a237e);justify-content:center;gap:14px;}
.acc-title{font-family:'Fredoka One',cursive;font-size:2.2rem;color:#fff;text-shadow:0 4px 16px rgba(0,0,0,.4);}
#accUser,#accPass{
  width:min(300px,80vw);padding:14px 18px;border:2px solid rgba(255,255,255,.2);
  border-radius:14px;background:rgba(255,255,255,.1);color:#fff;
  font-family:'Nunito',sans-serif;font-size:1rem;font-weight:700;outline:none;
}
#accUser::placeholder,#accPass::placeholder{color:rgba(255,255,255,.4);}
#accUser:focus,#accPass:focus{border-color:#ffd600;}
.acc-error{color:#ff8a80;font-size:.85rem;font-weight:700;min-height:1.2em;text-align:center;}
.acc-welcome{color:#fff;font-family:'Fredoka One',cursive;font-size:1.3rem;text-align:center;}
.acc-welcome b{color:#ffd600;}
.btn-account{background:linear-gradient(135deg,#42a5f5,#1565c0);color:#fff;}
.menu-user{color:rgba(255,255,255,.7);font-size:.9rem;font-weight:700;}
.menu-user b{color:#ffd600;}

/* ═══ LEADERBOARD SCREEN ═══ */
#sLeaderboard{background:linear-gradient(160deg,#1565c0,#0d47a1,#1a237e);padding-bottom:max(env(safe-area-inset-bottom,0px),20px);}
.lb-header{position:sticky;top:0;width:100%;z-index:10;background:rgba(21,101,192,.97);padding:max(env(safe-area-inset-top,0px),12px) 16px 12px;display:flex;align-items:center;justify-content:space-between;}
.lb-title{font-family:'Fredoka One',cursive;font-size:1.7rem;color:#fff;}
.lb-tabs{display:flex;gap:8px;padding:10px 16px 0;width:100%;max-width:500px;}
.lb-tab{flex:1;padding:10px;border:2px solid transparent;border-radius:14px;background:rgba(255,255,255,.1);color:#fff;font-family:'Fredoka One',cursive;font-size:.95rem;cursor:pointer;}
.lb-tab.active{border-color:#ffd600;background:rgba(255,214,0,.2);}
.lb-list{width:100%;max-width:500px;padding:10px 16px;overflow-y:auto;flex:1;}
.lb-row{display:flex;align-items:center;gap:10px;padding:10px 14px;background:rgba(255,255,255,.08);border-radius:12px;margin-bottom:6px;}
.lb-row.lb-me{background:rgba(255,214,0,.15);border:1px solid rgba(255,214,0,.3);}
.lb-rank{font-family:'Fredoka One',cursive;font-size:1.1rem;color:#ffd600;min-width:40px;text-align:center;}
.lb-name{flex:1;color:#fff;font-weight:800;font-size:.95rem;overflow:hidden;text-overflow:ellipsis;}
.lb-score{font-family:'Fredoka One',cursive;font-size:1.2rem;color:#ffd600;}
.lb-loading{color:rgba(255,255,255,.5);font-weight:700;text-align:center;padding:40px 0;}
.lb-empty{color:rgba(255,255,255,.5);font-weight:700;text-align:center;padding:40px 20px;}
.btn-lb{background:linear-gradient(135deg,#ffa726,#ef6c00);color:#fff;}
